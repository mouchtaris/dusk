# vim: et ft=ruby ts=4 sw=4

def XS_RUN = !which xs-run;
def CI_TEST = "ci/ci-test";

def p = !printf "%s " $args;
def join = !printf "%s" $args;

let XS_RUN = XS_RUN;
let CI_TEST = CI_TEST;

let ci_test = !cat $CI_TEST;

let script =
    p $ci_test ";" $args "; 0"
;

let exec_header =
    join "#!" $XS_RUN "\n"
;

src compile =
    !xs-compile
        <$script
        /dev/stdin /dev/stdout
;
!xs-run <$compile /dev/stdin;

0
