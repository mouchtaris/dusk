# vim: ft=scala

def cp = !cp -av $args;
def sudo_cp = !sudo cp -v $args;

def copy_to_target = {
  cp target/release/xs-compile $args;
  cp target/release/xs-run $args;
  cp target/release/xs-make-self-exec $args;
  cp target/release/xs-write_file $args;
  0
}

def sudo_copy_to_target = {
  sudo_cp target/release/xs-compile $args;
  sudo_cp target/release/xs-run $args;
  sudo_cp target/release/xs-make-self-exec $args;
  sudo_cp target/release/xs-write_file $args;
  0
}

!cargo build --color always --release
  # --features serde_cbor
  ;
!mkdir -p ./bin/;

copy_to_target ./bin/;
sudo_copy_to_target "/usr/local/bin";

cp target/release/main ./bin/xs2;
sudo_cp target/release/main /usr/local/bin/xs2;

0
